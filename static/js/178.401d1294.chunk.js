"use strict";(self.webpackChunksamurai_way=self.webpackChunksamurai_way||[]).push([[178],{5178:function(e,s,r){r.r(s),r.d(s,{DialogsContainer:function(){return ae},DialogsContainerApi:function(){return re}});var n=r(5671),a=r(3144),t=r(136),o=r(7277),i=r(2791),l=r(8468),d=r(5874),c=r(5052),u=r(9603),h=r(9439),f="Search_autoComlete__Kdx4p",p=r(3963),g=r(8442),m=r(7449),v=r(1694),x=r.n(v),j=r(6927),Z=r(1498),w=r(1929),y=r(6688),U=r(7268),C=r(1113),T=y.Z.Option;function I(e){return e&&e.type&&(e.type.isSelectOption||e.type.isSelectOptGroup)}var P=function(e,s){var r,n=e.prefixCls,a=e.className,t=e.popupClassName,o=e.dropdownClassName,l=e.children,d=e.dataSource,c=(0,j.Z)(l);if(1===c.length&&(0,C.l$)(c[0])&&!I(c[0])){var u=(0,m.Z)(c,1);r=u[0]}var h,f=r?function(){return r}:void 0;return h=c.length&&I(c[0])?l:d?d.map((function(e){if((0,C.l$)(e))return e;switch((0,g.Z)(e)){case"string":return i.createElement(T,{key:e,value:e},e);case"object":var s=e.value;return i.createElement(T,{key:s,value:s},e.text);default:return}})):[],i.createElement(w.C,null,(function(r){var l=(0,r.getPrefixCls)("select",n);return i.createElement(y.Z,(0,p.Z)({ref:s},(0,Z.Z)(e,["dataSource","dropdownClassName"]),{prefixCls:l,popupClassName:t||o,className:x()(l+"-auto-complete",a),mode:y.Z.SECRET_COMBOBOX_MODE_DO_NOT_USE},{getInputElement:f}),h)}))},_=i.forwardRef(P),N=(0,U.Z)(_);_.Option=T,_._InternalPanelDoNotUseOrYouWillBeFired=N;var O=_,S=r(300),F=r(1523),k=r(4547),D=r(7724),A=r(184),E=function(e){var s=e.data,r=e.addTochedUser,n=e.placeholder,a=e.getSearchUsers,t=i.useState([]),o=(0,h.Z)(t,2),l=o[0],d=o[1];return(0,A.jsx)(O,{options:l,className:f,onSearch:function(e){var n;d(e?(n=e,s.filter((function(e){return e.name.toLowerCase().includes(n)})).map((function(e){var s=(0,D.x)(e.photos.small);return{value:e.name,label:(0,A.jsx)(F.OL,{style:{color:"black"},onClick:function(){r&&r({id:e.id,name:e.name})},to:"/dialog/"+e.id,children:(0,A.jsxs)(c.Z,{align:"middle",children:[(0,A.jsx)("img",{className:k.Z.avatar,src:s,alt:"avatar"})," ",(0,A.jsxs)("span",{style:{paddingLeft:5},children:[" ",e.name]})]})},e.id)}}))):[])},onSelect:function(e){a&&a(e)},children:(0,A.jsx)(S.Z.Search,{placeholder:n,enterButton:!0})})},b=r(6864),L=r(1938),B=r(7263),M="FriendsList_nextPrev__-F7Zf",R=r(2610),V=function(e){var s=e.friends,r=e.addTochedUser,n=e.changeFollowUnfollow,a=e.followingInProgress,t=e.isOwner,o=i.useState(7),l=(0,h.Z)(o,2),d=l[0],f=l[1],p=i.useState(0),g=(0,h.Z)(p,2),m=g[0],v=g[1],x=s.slice(m,d),j=s.length/d>1,Z=0!==m,w=x.map((function(e){var s=(0,D.x)(e.photos.small);return(0,A.jsx)(B.Z,{addTochedUser:r,followingInProgress:a,unfriend:n,isOwner:t,navigate:R._.toDialog,user:e,photo:s},e.id)}));return(0,A.jsxs)(c.Z,{align:"middle",children:[(0,A.jsx)(u.Z,{span:1,children:Z&&(0,A.jsx)(b.Z,{className:M,style:{fontSize:20},onClick:function(){v(m-7),f(d-7)}})}),(0,A.jsx)(u.Z,{span:22,children:(0,A.jsxs)(c.Z,{justify:"space-evenly",children:[" ",w]})}),(0,A.jsx)(u.Z,{span:1,children:j&&(0,A.jsx)(L.Z,{className:M,onClick:function(){f(d+7),v(m+7)},style:{fontSize:20}})})]})},$=r(7128),z=r(6744),q="Message_messageContainer__8c4PQ",G="Message_messege__C9nb2",K=(0,i.forwardRef)((function(e,s){var r=e.avatar,n=e.myAvatarValue,a=e.f,t=e.messege,o=e.addTochedUser;return(0,A.jsxs)(F.OL,{to:R._.toDialog+a.id,ref:s,onClick:function(){return o({id:a.id,name:a.name})},children:[(0,A.jsxs)(c.Z,{justify:"space-evenly",className:q,children:[(0,A.jsx)(u.Z,{children:(0,A.jsx)("img",{className:z.Z.avatar,src:r,alt:"avatar"})}),(0,A.jsxs)(u.Z,{children:[(0,A.jsxs)(c.Z,{children:[" ",a.name," "]}),(0,A.jsxs)(c.Z,{align:"middle",style:{marginBottom:10},children:[(0,A.jsx)(u.Z,{children:(0,A.jsx)(c.Z,{justify:"center",children:(0,A.jsx)("img",{className:k.Z.avatar,src:n,alt:"avatar"})})}),(0,A.jsx)(u.Z,{children:(0,A.jsxs)("span",{className:G,children:[" ",t]})})]})]})]}),(0,A.jsx)($.Z,{style:{margin:10}})]})})),Q=function(e){var s=e.friends,r=e.addTochedUser,n=e.myAvatar,a=e.messege,t=i.useState(7),o=(0,h.Z)(t,2),l=o[0],d=o[1],c=s.slice(0,l),u=s.length,f=(0,i.createRef)(),p=(0,i.useRef)(null),g=function(e){e[0].isIntersecting&&u/l>1&&d(l+7)};(0,i.useEffect)((function(){p.current&&p.current.disconnect(),p.current=new IntersectionObserver(g),f.current&&p.current.observe(f.current)}),[f]);var m=c.map((function(e,s){var t=(0,D.x)(n),o=(0,D.x)(e.photos.small);return s+1===c.length?(0,A.jsx)(K,{addTochedUser:r,avatar:o,ref:f,myAvatarValue:t,f:e,messege:a},e.id):(0,A.jsx)(K,{addTochedUser:r,avatar:o,myAvatarValue:t,f:e,messege:a},e.id)}));return(0,A.jsx)(A.Fragment,{children:m})},W=r(5931),X=function(e){var s=e.friends,r=e.myAvatar,n=e.tochedUsers,a=e.addTochedUser,t=e.message,o=e.removeTochedUser,i=e.followingInProgress,l=e.changeFollowUnfollow,h=e.isOwner;return console.log("dialogs"),(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(c.Z,{style:{marginTop:20},children:[(0,A.jsxs)(u.Z,{className:"gutter-row",span:15,children:[(0,A.jsxs)("div",{className:d.Z.profileInfoContainer,children:[(0,A.jsx)(E,{data:s,placeholder:"Find friends dialiog",addTochedUser:a}),(0,A.jsx)(V,{followingInProgress:i,changeFollowUnfollow:l,isOwner:h,friends:s,addTochedUser:a})]}),(0,A.jsx)("div",{className:d.Z.profileInfoContainer,children:(0,A.jsx)(Q,{friends:s,addTochedUser:a,myAvatar:r,messege:t})})]}),(0,A.jsx)(u.Z,{className:"gutter-row",span:9,children:(0,A.jsx)(W.V,{removeTochedUser:o,tochedUsers:n})})]})})},Y=r(364),H=r(7781),J=r(2932),ee=r(3906),se=r(2648),re=function(e){(0,t.Z)(r,e);var s=(0,o.Z)(r);function r(){return(0,n.Z)(this,r),s.apply(this,arguments)}return(0,a.Z)(r,[{key:"componentDidMount",value:function(){this.props.profileId!==this.props.myId&&(this.props.getUserProfile(this.props.myId),this.props.getFriend(!0)),0===this.props.friends.length&&this.props.getFriend(!0)}},{key:"render",value:function(){return(0,A.jsx)(X,{friends:this.props.friends,tochedUsers:this.props.tochedUsers,message:this.props.message,myAvatar:this.props.myAvatar,removeTochedUser:this.props.removeTochedUser,addTochedUser:this.props.addTochedUser,followingInProgress:this.props.followingInProgress,changeFollowUnfollow:this.props.changeFollowUnfollow,isOwner:this.props.myId===this.props.profileId})}}]),r}(i.PureComponent),ne={addTochedUser:l.up,removeTochedUser:l.To,getFriend:ee.rj,getUserProfile:se.et,changeFollowUnfollow:ee.ly},ae=(0,H.qC)((0,Y.$j)((function(e){var s;return{tochedUsers:e.dialogsPage.touchedUsers,friends:e.usersPage.friends,myAvatar:e.auth.avatar,message:e.dialogsPage.messagesData[e.dialogsPage.messagesData.length-1].message,profileId:null===(s=e.profilePage.profile)||void 0===s?void 0:s.userId,myId:e.auth.id,isLoading:e.usersPage.isLoading,followingInProgress:e.usersPage.followingInProgress}}),ne),J.D)(re)}}]);
//# sourceMappingURL=178.401d1294.chunk.js.map